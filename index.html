<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Water Interruption Summary</title>
<style>
body {
    font-family: Arial, sans-serif;
    padding: 20px;
    background: #f9f9f9;
    margin: 0;
}
h2 {
    text-align: center;
    font-size: 1.5rem;
}
label {
    display: block;
    margin-top: 15px;
    font-weight: bold;
    font-size: 1rem;
}
input, select, textarea {
    width: 100%;
    padding: 10px;
    margin-top: 5px;
    box-sizing: border-box;
    font-size: 1rem;
    border-radius: 5px;
    border: 1px solid #ccc;
}
textarea {
    resize: vertical;
}
button {
    padding: 12px;
    margin-top: 15px;
    cursor: pointer;
    border: none;
    border-radius: 5px;
    font-size: 1rem;
}
#generateBtn {
    background-color: #28a745;
    color: white;
    width: 100%;
}
#whatsappBtn {
    background-color: #25D366;
    color: white;
}
#copyBtn {
    background-color: #007BFF;
    color: white;
}
#message {
    width: 100%;
    height: 300px;
    margin-top: 15px;
    padding: 10px;
    font-size: 1rem;
    border-radius: 5px;
    border: 1px solid #ccc;
}
.button-container {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    margin-top: 10px;
}
.button-container button {
    flex: 1;
    min-width: 120px;
}
.hidden { display: none; }

/* Mobile responsiveness tweaks */
@media (max-width: 480px) {
    body { padding: 10px; }
    h2 { font-size: 1.3rem; }
    label { font-size: 0.95rem; }
    input, select, textarea { font-size: 0.95rem; padding: 8px; }
    button { font-size: 0.95rem; padding: 10px; }
    #message { height: 250px; font-size: 0.95rem; }
}
</style>
</head>
<body>

<h2>Water Interruption Summary</h2>

<form id="reportForm">
<label for="caseType">Case Type</label>
<select id="caseType">
  <option>Major Leakage</option>
  <option>Minor Leakage</option>
  <option>3rd Party Damage</option>
  <option>Project S/D</option>
</select>

<!-- 3rd Party Damage fields -->
<div id="thirdPartyFields" class="hidden">
  <label for="damagedBy">Damaged By</label>
  <input type="text" id="damagedBy" placeholder="Enter company that damaged the asset">

  <label for="repairBy">Repair By</label>
  <input type="text" id="repairBy" placeholder="Enter company that will repair the asset">
</div>

<!-- Affected Asset / Work Scope -->
<label for="asset" id="assetLabel">Affected Asset</label>
<input type="text" id="asset">

<!-- Done By (Project S/D) -->
<div id="doneByField" class="hidden">
  <label for="doneBy">Done By</label>
  <input type="text" id="doneBy" placeholder="Enter company that did the work">
</div>

<label for="location">Location</label>
<input type="text" id="location">

<label for="isolatingTime">Isolating Time</label>
<input type="datetime-local" id="isolatingTime" step="900">

<label for="isolationStatus">Isolation Status</label>
<select id="isolationStatus">
  <option>Isolated</option>
  <option>Not Isolated</option>
</select>

<label for="numValves">Num. of Valves</label>
<input type="number" id="numValves">

<label for="customer">Customers Affected</label>
<input type="text" id="customer">

<label for="vip">VIP Affected</label>
<select id="vip">
  <option>Yes</option>
  <option>No</option>
</select>

<label for="altSource">Alternative Source</label>
<select id="altSource">
  <option>Yes</option>
  <option>No</option>
</select>

<label for="expectedRestoration">Expected Restoration Time</label>
<select id="expectedRestoration">
  <option>Less than 1 Hour</option>
  <option>1 Hour</option>
  <option>2 Hours</option>
  <option>3 Hours</option>
  <option>4 Hours</option>
  <option>5 Hours</option>
  <option>6 Hours</option>
  <option>7 Hours</option>
  <option>8 Hours</option>
  <option>9 Hours</option>
  <option>10 Hours</option>
  <option>11 Hours</option>
  <option>12 Hours</option>
  <option>13 Hours</option>
  <option>14 Hours</option>
  <option>15 Hours</option>
  <option>16 Hours</option>
  <option>17 Hours</option>
  <option>18 Hours</option>
  <option>19 Hours</option>
  <option>20 Hours</option>
  <option>21 Hours</option>
  <option>22 Hours</option>
  <option>23 Hours</option>
  <option>24 Hours</option>
  <option>24+ Hours</option>
</select>

<label for="currentSituation">Current Situation</label>
<textarea id="currentSituation" placeholder="Describe current situation"></textarea>

</form>

<button id="generateBtn">Generate Message</button>

<textarea id="message" placeholder="Generated message will appear here..." readonly></textarea>

<div class="button-container">
<button id="whatsappBtn">Send to WhatsApp</button>
<button id="copyBtn">Copy to Clipboard</button>
</div>

<script>
function formatDateTime(input) {
    const date = new Date(input);
    const day = String(date.getDate()).padStart(2, '0');
    const month = String(date.getMonth()+1).padStart(2, '0');
    let hours = date.getHours();
    let minutes = String(date.getMinutes()).padStart(2, '0');
    const ampm = hours >= 12 ? 'PM' : 'AM';
    hours = hours % 12 || 12;
    return `${day}/${month} | ${hours}:${minutes} ${ampm}`;
}

// Handle case type changes
document.getElementById('caseType').addEventListener('change', function() {
    const value = this.value;

    const thirdPartyFields = document.getElementById('thirdPartyFields');
    if (value === "3rd Party Damage") {
        thirdPartyFields.classList.remove('hidden');
    } else {
        thirdPartyFields.classList.add('hidden');
    }

    const assetLabel = document.getElementById('assetLabel');
    const doneByField = document.getElementById('doneByField');
    if (value === "Project S/D") {
        assetLabel.textContent = "Work Scope";
        doneByField.classList.remove('hidden');
    } else {
        assetLabel.textContent = "Affected Asset";
        doneByField.classList.add('hidden');
    }
});

document.getElementById('generateBtn').addEventListener('click', function() {
    let msg = `*Case Type:* ${document.getElementById('caseType').value}`;

    if (document.getElementById('caseType').value === "3rd Party Damage") {
        msg += `\n*Damaged By:* ${document.getElementById('damagedBy').value}
*Repair By:* ${document.getElementById('repairBy').value}`;
    }

    if (document.getElementById('caseType').value === "Project S/D") {
        msg += `\n*Work Scope:* ${document.getElementById('asset').value}
*Done By:* ${document.getElementById('doneBy').value}`;
    } else if (document.getElementById('caseType').value !== "3rd Party Damage") {
        msg += `\n*Affected Asset:* ${document.getElementById('asset').value}`;
    }

    msg += `
*Location:* ${document.getElementById('location').value}
*Isolating Time:* ${formatDateTime(document.getElementById('isolatingTime').value)}
*Isolation Status:* ${document.getElementById('isolationStatus').value}
*Num. of Valves:* ${document.getElementById('numValves').value}
*Customers Affected:* ${document.getElementById('customer').value}
*VIP Affected:* ${document.getElementById('vip').value}
*Alternative Source:* ${document.getElementById('altSource').value}
*Expected Restoration Time:* ${document.getElementById('expectedRestoration').value}
*Current Situation:* ${document.getElementById('currentSituation').value}`;

    document.getElementById('message').value = msg;
});

document.getElementById('whatsappBtn').addEventListener('click', function() {
    const text = encodeURIComponent(document.getElementById('message').value);
    window.open(`https://wa.me/?text=${text}`, '_blank');
});

document.getElementById('copyBtn').addEventListener('click', function() {
    navigator.clipboard.writeText(document.getElementById('message').value);
    alert('Message copied to clipboard!');
});
</script>

</body>
</html>
